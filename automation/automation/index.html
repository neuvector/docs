<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-5.3 docs-doc-page docs-doc-id-automation/automation/automation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">REST API and Automation | Neuvector Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://open-docs.neuvector.com/automation/automation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="5.3"><meta data-rh="true" name="docusaurus_tag" content="docs-default-5.3"><meta data-rh="true" name="docsearch:version" content="5.3"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-5.3"><meta data-rh="true" property="og:title" content="REST API and Automation | Neuvector Docs"><meta data-rh="true" name="description" content="NeuVector Automation"><meta data-rh="true" property="og:description" content="NeuVector Automation"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://open-docs.neuvector.com/automation/automation"><link data-rh="true" rel="alternate" href="https://open-docs.neuvector.com/automation/automation" hreflang="en"><link data-rh="true" rel="alternate" href="https://open-docs.neuvector.com/automation/automation" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c7e9e479.css">
<script src="/assets/js/runtime~main.6538cbff.js" defer="defer"></script>
<script src="/assets/js/main.35ac67e1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Neuvector Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-dark.svg" alt="Neuvector Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/">5.3</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/automation/automation">Next ðŸš§</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/automation/automation">5.3</a></li><li><a class="dropdown__link" href="/5.2/automation/automation">5.2</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Quick Links</a><ul class="dropdown__menu"><li><a href="https://neuvector.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Neuvector Home<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/neuvector/neuvector/" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/neuvector/docs/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Docs GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://hub.docker.com/u/neuvector" target="_blank" rel="noopener noreferrer" class="dropdown__link">NeuVector images on Docker Hub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More From SUSE</a><ul class="dropdown__menu"><li><a href="https://www.rancher.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher">Rancher</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="http://harvesterhci.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__harvester">Harvester</a></li><li><a href="http://fleet.rancher.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__fleet">Fleet</a></li><li><a href="http://kubewarden.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__kubewarden">Kubewarden</a></li><li><a href="https://rancherdesktop.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rd">Rancher Desktop</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://opensource.suse.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__suse">More Projects...</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/">1. Basics</a><button aria-label="Expand sidebar category &#x27;1. Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/deploying">2. Deploying NeuVector 5.x</a><button aria-label="Expand sidebar category &#x27;2. Deploying NeuVector 5.x&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/configuration">3. Initial Configuration &amp; Console Login</a><button aria-label="Expand sidebar category &#x27;3. Initial Configuration &amp; Console Login&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/navigation">4. Navigating NeuVector</a><button aria-label="Expand sidebar category &#x27;4. Navigating NeuVector&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/policy">5. Security Policy</a><button aria-label="Expand sidebar category &#x27;5. Security Policy&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/scanning">6. Security Risks, Scanning &amp; Compliance</a><button aria-label="Expand sidebar category &#x27;6. Security Risks, Scanning &amp; Compliance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/reporting">7. Reporting</a><button aria-label="Expand sidebar category &#x27;7. Reporting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/integration">8. Enterprise Integration</a><button aria-label="Expand sidebar category &#x27;8. Enterprise Integration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/testing">9. Testing NeuVector</a><button aria-label="Expand sidebar category &#x27;9. Testing NeuVector&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/updating">10. Updating NeuVector</a><button aria-label="Expand sidebar category &#x27;10. Updating NeuVector&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/automation">11. Workflow &amp; Automation</a><button aria-label="Collapse sidebar category &#x27;11. Workflow &amp; Automation&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/automation/ci_workflow">NeuVector Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/automation/automation">REST API and Automation</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/troubleshooting">12. Troubleshooting</a><button aria-label="Expand sidebar category &#x27;12. Troubleshooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/special">13. Special Use Cases With Allinone</a><button aria-label="Expand sidebar category &#x27;13. Special Use Cases With Allinone&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/releasenotes">14. Release Notes</a><button aria-label="Expand sidebar category &#x27;14. Release Notes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/automation"><span itemprop="name">11. Workflow &amp; Automation</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">REST API and Automation</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 5.3</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>REST API and Automation</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="neuvector-automation">NeuVector Automation<a href="#neuvector-automation" class="hash-link" aria-label="Direct link to NeuVector Automation" title="Direct link to NeuVector Automation">â€‹</a></h3>
<p>There are many automation features in NeuVector to support the entire CI/CD workflow, including:</p>
<ul>
<li>Jenkins plug-in to automated scanning during build</li>
<li>Registry scanning to automate repository monitoring</li>
<li>Admission Control policies to allow/deny unauthorized deployments</li>
<li>CIS benchmarks automatically run on hosts</li>
<li>Helm chart on github for automated deployment on Kubernetes</li>
<li>Response rules to automate responses to security events</li>
<li>REST API for building automation of any NeuVector function</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rest-api">REST API<a href="#rest-api" class="hash-link" aria-label="Direct link to REST API" title="Direct link to REST API">â€‹</a></h4>
<p>The NeuVector solution can be managed using the REST API. Below are common examples of automation using the REST API. The REST API yaml doc is best viewed in the Swagger 2.0 viewer. The REST API documentation is below in a yaml file which is best viewed in a reader such as swagger.io.</p>
<p>Latest update can be found <a href="https://raw.githubusercontent.com/neuvector/neuvector/main/controller/api/apis.yaml" target="_blank" rel="noopener noreferrer">here</a>. Also in the NeuVector GitHub source code <a href="https://github.com/neuvector/neuvector/blob/main/controller/api/apis.yaml" target="_blank" rel="noopener noreferrer">repo</a>.  The apis.yaml from the main truck can include unreleased features.  It is recommended to download the appropriate released version source code and extract the apis.yaml from the controller/api folder.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>If you are making REST API calls with username/password, please be sure make a DELETE call against /v1/auth when done. There is a maximum of 32 concurrent sessions for each user. If this is exceeded, an authentication failure will occur.</p></div></div>
<p>NeuVector also support Response Rules to automate common responses to security events or vulnerabilities detected. Please see the section Security Policy -&gt; Response Rules for more details.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="expose-rest-api-in-kubernetes">Expose REST API in Kubernetes<a href="#expose-rest-api-in-kubernetes" class="hash-link" aria-label="Direct link to Expose REST API in Kubernetes" title="Direct link to Expose REST API in Kubernetes">â€‹</a></h4>
<p>To expose the REST API for access from outside of the Kubernetes cluster, enable port 10443.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> neuvector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">svc</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">controller</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> neuvector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">protocol</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> LoadBalancer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> neuvector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">controller</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p><code>type: NodePort</code> can also be used instead of LoadBalancer.</p></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If using type LoadBalancer, set the <em>controllerIP</em> in the examples below to the external IP or URL for the loadbalancer.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-for-rest-api">Authentication for REST API<a href="#authentication-for-rest-api" class="hash-link" aria-label="Direct link to Authentication for REST API" title="Direct link to Authentication for REST API">â€‹</a></h4>
<p>The REST API supports two types of authentication: username/password and token. Both can be configured in Settings -&gt; Users, API Keys &amp; Roles, and be associated with default or custom roles to limit access privileges. The examples below show username/password based authentication where a token is created first, then used in subsequent REST API calls. If using a token, it can be used directly in each REST API call. Note: username based connections have a limited number of concurrent sessions, so it is important to delete the username token as shown below when finished. Token based authentication does not have a limit, but expire according to the time limit selected when created.</p>
<p>For token-based authentication, see the following screen shots and example call. Be sure to copy the secret and token once created, as there is no way to retrieve this after the screen in closed.</p>
<p><img decoding="async" loading="lazy" alt="token" src="/assets/images/5_2_api_key-6a4f8ec0c2cf954b54b35110fc240e21.png" width="1040" height="508" class="img_CujE"></p>
<p><img decoding="async" loading="lazy" alt="token" src="/assets/images/5_2_api_created-fc1219aacfc054ecad213638b0d3620b.png" width="939" height="457" class="img_CujE"></p>
<p><img decoding="async" loading="lazy" alt="token" src="/assets/images/5_2_api_key_header-76edb46b0219f0765293dcb32d6d7921.png" width="1110" height="82" class="img_CujE"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="trigger-vulnerability-scanning-from-a-script">Trigger Vulnerability Scanning from a script<a href="#trigger-vulnerability-scanning-from-a-script" class="hash-link" aria-label="Direct link to Trigger Vulnerability Scanning from a script" title="Direct link to Trigger Vulnerability Scanning from a script">â€‹</a></h4>
<p>NeuVector can be triggered automatically to scan an image for vulnerabilities. This can be done by configuring a registry/repository to be monitored, using the NeuVector Jenkins plug-in, or using the REST API. Please see the section on Scanning &amp; Compliance for more detail.</p>
<p>The sample script below shows how to remotely pull the container, run it, and scan it. It can be triggered from a Jenkins task (remote shell) or any CI/CD tool. A JSON parser tool (jq) is also used.</p>
<p>Be sure to enter the controller IP address in the script and change the container image name to the one you wish to scan. Also, update the username/password fields.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">_curCase_=`echo $0 | awk -F&quot;.&quot; &#x27;{print $(NF-1)}&#x27; | awk -F&quot;/&quot; &#x27;{print $NF}&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_DESC_=&quot;able to scan ubuntu:16.04 image&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_ERRCODE_=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_ERRTYPE_=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_RESULT_=&quot;pass&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># please remember to specify the controller ip address here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_controllerIP_=&quot;&lt;your_controller_ip&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_controllerRESTAPIPort_=&quot;10443&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_neuvectorUsername_=&quot;admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_neuvectorPassword_=&quot;admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_registryURL_=&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_registryUsername_=&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_registryPassword_=&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_repository_=&quot;alpine&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_tag_=&quot;latest&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -d &#x27;{&quot;password&quot;: {&quot;username&quot;: &quot;&#x27;$_neuvectorUsername_&#x27;&quot;, &quot;password&quot;: &quot;&#x27;$_neuvectorPassword_&#x27;&quot;}}&#x27; &quot;https://$_controllerIP_:$_controllerRESTAPIPort_/v1/auth&quot; &gt; /dev/null 2&gt;&amp;1 &gt; token.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_TOKEN_=`cat token.json | jq -r &#x27;.token.token&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` scanning an image ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;request&quot;: {&quot;registry&quot;: &quot;&#x27;$_registryURL_&#x27;&quot;, &quot;username&quot;: &quot;&#x27;$_registryUsername_&#x27;&quot;, &quot;password&quot;: &quot;&#x27;$_registryPassword_&#x27;&quot;, &quot;repository&quot;: &quot;&#x27;$_repository_&#x27;&quot;, &quot;tag&quot;: &quot;&#x27;$_tag_&#x27;&quot;}}&#x27; &quot;https://$_controllerIP_:$_controllerRESTAPIPort_/v1/scan/repository&quot; &gt; /dev/null 2&gt;&amp;1 &gt; scan_repository.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while [ `wc -c &lt; scan_repository.json` = &quot;0&quot; ]; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo `date +%Y%m%d_%H%M%S` scanning is still in progress ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sleep 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;request&quot;: {&quot;registry&quot;: &quot;&#x27;$_registryURL_&#x27;&quot;, &quot;username&quot;: &quot;&#x27;$_registryUsername_&#x27;&quot;, &quot;password&quot;: &quot;&#x27;$_registryPassword_&#x27;&quot;, &quot;repository&quot;: &quot;&#x27;$_repository_&#x27;&quot;, &quot;tag&quot;: &quot;&#x27;$_tag_&#x27;&quot;}}&#x27; &quot;https://$_controllerIP_:$_controllerRESTAPIPort_/v1/scan/repository&quot; &gt; /dev/null 2&gt;&amp;1 &gt; scan_repository.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` log out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X &#x27;DELETE&#x27; -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; &quot;https://$_controllerIP_:$_controllerRESTAPIPort_/v1/auth&quot; &gt; /dev/null 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat scan_repository.json | jq .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm *.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] $_DESC_: $_RESULT_-$_ERRCODE_</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>You may need to install jq</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo yum install jq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<p>For Kubernetes based deployments you can set the Controller IP as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">_podNAME_=`kubectl get pod -n neuvector -o wide | grep &quot;allinone\|controller&quot; | head -n 1 | awk &#x27;{print $1}&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_controllerIP_=`kubectl exec $_podNAME_ -n neuvector -- consul info | grep leader_addr | awk -F&quot;:| &quot; &#x27;{print $3}&#x27;`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>In a multiple controller deployment the requests must be sent to a single controller IP so multiple requests for status of long running image scans go to the controller performing the scan.</p></div></div>
<p>For scanning locally instead of in a registry:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;request&quot;: {&quot;tag&quot;: &quot;3.4&quot;, &quot;repository&quot;: &quot;nvlab/alpine&quot;, &quot;scan_layers&quot;: true}}&#x27; &quot;https://$_controllerIP_:443/v1/scan/repository&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Sample output:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;report&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;image_id&quot;: &quot;c7fc7faf8c28d48044763609508ebeebd912ad6141a722386b89d044b62e4d45&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;registry&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;repository&quot;: &quot;nvlab/alpine&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;tag&quot;: &quot;3.4&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;digest&quot;: &quot;sha256:2441496fb9f0d938e5f8b27aba5cc367b24078225ceed82a9a5e67f0d6738c80&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;base_os&quot;: &quot;alpine:3.4.6&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;cvedb_version&quot;: &quot;1.568&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;vulnerabilities&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;name&quot;: &quot;CVE-2018-0732&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;score&quot;: 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;severity&quot;: &quot;Medium&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;vectors&quot;: &quot;AV:N/AC:L/Au:N/C:N/I:N/A:P&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;description&quot;: &quot;During key agreement in a TLS handshake using a DH(E) based ciphersuite a malicious server can send a very large prime value to the client. This will cause the client to spend an unreasonably long period of time generating a key for this prime resulting in a hang until the client has finished. This could be exploited in a Denial Of Service attack. Fixed in OpenSSL 1.1.0i-dev (Affected 1.1.0-1.1.0h). Fixed in OpenSSL 1.0.2p-dev (Affected 1.0.2-1.0.2o).&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;package_name&quot;: &quot;openssl&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;package_version&quot;: &quot;1.0.2n-r0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;fixed_version&quot;: &quot;1.0.2o-r1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;link&quot;: &quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0732&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;score_v3&quot;: 7.5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;vectors_v3&quot;: &quot;CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;layers&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;digest&quot;: &quot;c68318b6ae6a2234d575c4b6b33844e3e937cf608c988a0263345c1abc236c14&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;cmds&quot;: &quot;/bin/sh&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;vulnerabilities&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;CVE-2018-0732&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;score&quot;: 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;severity&quot;: &quot;Medium&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;vectors&quot;: &quot;AV:N/AC:L/Au:N/C:N/I:N/A:P&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;description&quot;: &quot;During key agreement in a TLS handshake using a DH(E) based ciphersuite a malicious server can send a very large prime value to the client. This will cause the client to spend an unreasonably long period of time generating a key for this prime resulting in a hang until the client has finished. This could be exploited in a Denial Of Service attack. Fixed in OpenSSL 1.1.0i-dev (Affected 1.1.0-1.1.0h). Fixed in OpenSSL 1.0.2p-dev (Affected 1.0.2-1.0.2o).&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;package_name&quot;: &quot;openssl&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;package_version&quot;: &quot;1.0.2n-r0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;fixed_version&quot;: &quot;1.0.2o-r1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;link&quot;: &quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0732&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;score_v3&quot;: 7.5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;vectors_v3&quot;: &quot;CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;size&quot;: 5060096</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-policy-rules-automatically">Create Policy Rules Automatically<a href="#create-policy-rules-automatically" class="hash-link" aria-label="Direct link to Create Policy Rules Automatically" title="Direct link to Create Policy Rules Automatically">â€‹</a></h4>
<p>To create a new rule in the NeuVector policy controller, the groups for the FROM and TO fields must exist first. The following sample creates a new Group based on the container label nv-service-type=data, and another Group for label nv-service-type=website. A rule is then created to allow traffic from the wordpress container to the mysql container using only the mysql protocol.</p>
<p>Be sure to update the username and password for access to the controller.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TOKEN_JSON=$(curl -k -H &quot;Content-Type: application/json&quot; -d &#x27;{&quot;password&quot;: {&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;}}&#x27; &quot;https://`docker inspect neuvector.allinone | jq -r &#x27;.[0].NetworkSettings.IPAddress&#x27;`:10443/v1/auth&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_TOKEN_=`echo $TOKEN_JSON | jq -r &#x27;.token.token&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;config&quot;: {&quot;name&quot;: &quot;mydb&quot;, &quot;criteria&quot;: [{&quot;value&quot;: &quot;data&quot;, &quot;key&quot;: &quot;nv.service.type&quot;, &quot;op&quot;: &quot;=&quot;}]}}&#x27; &quot;https://`docker inspect neuvector.allinone | jq -r &#x27;.[0].NetworkSettings.IPAddress&#x27;`:10443/v1/group&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;config&quot;: {&quot;name&quot;: &quot;mywp&quot;, &quot;criteria&quot;: [{&quot;value&quot;: &quot;website&quot;, &quot;key&quot;: &quot;nv.service.type&quot;, &quot;op&quot;: &quot;=&quot;}]}}&#x27; &quot;https://`docker inspect neuvector.allinone | jq -r &#x27;.[0].NetworkSettings.IPAddress&#x27;`:10443/v1/group&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X &quot;PATCH&quot; -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;insert&quot;: {&quot;rules&quot;: [{&quot;comment&quot;: &quot;Custom WP Rule&quot;, &quot;from&quot;: &quot;mywp&quot;, &quot;applications&quot;: [&quot;MYSQL&quot;], &quot;ports&quot;: &quot;any&quot;, &quot;to&quot;: &quot;mydb&quot;, &quot;action&quot;: &quot;allow&quot;, &quot;id&quot;: 0}], &quot;after&quot;: 0}}&#x27; &quot;https://`docker inspect neuvector.allinone | jq -r &#x27;.[0].NetworkSettings.IPAddress&#x27;`:10443/v1/policy/rule&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X &quot;DELETE&quot; -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; &quot;https://`docker inspect neuvector.allinone | jq -r &#x27;.[0].NetworkSettings.IPAddress&#x27;`:10443/v1/auth&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the Groups already exist in NeuVector then the new rule can be created, skipping the Group creation steps. This example also removes the authentication token at the end. Note that a Rule ID number can be specified and NeuVector executes rules in numerical order lowest to highest.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="exportimport-configuration-file">Export/Import Configuration File<a href="#exportimport-configuration-file" class="hash-link" aria-label="Direct link to Export/Import Configuration File" title="Direct link to Export/Import Configuration File">â€‹</a></h4>
<p>Here are samples to backup the NeuVector configuration file automatically. You can select whether to export all configuration settings (policy, users, Settings etc), or only the policy.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>These samples are provided as examples only and are not officially supported unless a specific enterprise support agreement has been put in place.</p></div></div>
<p>To export all configuration:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./config.py export -u admin -w admin -s $_controllerIP_ -p $_controllerPort_ -f $_FILENAME_ # exporting the configuration with all settings</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To export policy only:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./config.py export -u admin -w admin -s $_controllerIP_ -p $_controllerPort_ -f $_FILENAME_ --section policy # exporting the configuration with policy only</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To import the file:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./config.py import -u admin -w admin -s $_controllerIP_ -p $_controllerPort_ -f $_FILENAME_ # importing the configuration</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Sample python files</strong> Contains config.py, client.py, and multipart.py. Download sample files: <a href="/assets/files/ImportExport-2e9976d25606bf04094c2e589955066d.zip" target="_blank">ImportExport</a>. Please put all three files in one folder to run above commands. You may need install some Python modules in order to run the script.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo pip install requests six</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="setting-or-changing-user-password">Setting or Changing User Password<a href="#setting-or-changing-user-password" class="hash-link" aria-label="Direct link to Setting or Changing User Password" title="Direct link to Setting or Changing User Password">â€‹</a></h4>
<p>Use the rest API calls for User management.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -k -H &#x27;Content-Type: application/json&#x27; -H &#x27;X-Auth-Token: c64125decb31e6d3125da45cba0f5025&#x27; https://127.0.0.1:10443/v1/user/admin -X PATCH -d &#x27;{&quot;config&quot;:{&quot;fullname&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;admin&quot;,&quot;new_password&quot;:&quot;NEWPASS&quot;}}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="starting-packet-capture-on-a-container">Starting Packet Capture on a Container<a href="#starting-packet-capture-on-a-container" class="hash-link" aria-label="Direct link to Starting Packet Capture on a Container" title="Direct link to Starting Packet Capture on a Container">â€‹</a></h4>
<p>When a container exhibits suspicious behavior, start a packet capture.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TOKEN_JSON=$(curl -k -H &quot;Content-Type: application/json&quot; -d &#x27;{&quot;password&quot;: {&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;}}&#x27; &quot;https://`docker inspect neuvector.allinone | jq -r &#x27;.[0].NetworkSettings.IPAddress&#x27;`:10443/v1/auth&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_TOKEN_=`echo $TOKEN_JSON | jq -r &#x27;.token.token&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;sniffer&quot;:{&quot;file_number&quot;:1,&quot;filter&quot;:&quot;port 1381&quot;}}&#x27; &quot;https://`docker inspect neuvector.allinone | jq -r &#x27;.[0].NetworkSettings.IPAddress&#x27;`:10443/v1/sniffer?f_workload=`docker inspect neuvector.allinone | jq -r .[0].Id`&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Donâ€™t forget to stop the sniffer session after some time so it doesnâ€™t run forever. Number of files to rotate has a maximum value of 50.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-and-accept-the-eula-new-deployments">Check and Accept the EULA (new deployments)<a href="#check-and-accept-the-eula-new-deployments" class="hash-link" aria-label="Direct link to Check and Accept the EULA (new deployments)" title="Direct link to Check and Accept the EULA (new deployments)">â€‹</a></h4>
<p>Get the authentication TOKEN as above. Also replace the controller IP address with your as appropriate.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -k -H &#x27;Content-Type: application/json&#x27; -H &#x27;X-Auth-Token: $_TOKEN_&#x27; https://127.0.0.1:10443/v1/eula | jq .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;eula&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;accepted&quot;:false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Accept EULA</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -k -H &#x27;Content-Type: application/json&#x27; -H &#x27;X-Auth-Token: $_TOKEN_&#x27; -d &#x27;{&quot;eula&quot;:{&quot;accepted&quot;:true}}&#x27; https://127.0.0.1:10443/v1/eula</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then check the EULA again.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configure-registry-scanning">Configure Registry Scanning<a href="#configure-registry-scanning" class="hash-link" aria-label="Direct link to Configure Registry Scanning" title="Direct link to Configure Registry Scanning">â€‹</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;request&quot;: {&quot;registry&quot;: &quot;https://registry.connect.redhat.com&quot;, &quot;username&quot;: &quot;username&quot;, &quot;password&quot;: &quot;password&quot;, &quot;tag&quot;: &quot;latest&quot;, &quot;repository&quot;: &quot;neuvector/enforcer&quot;}}&#x27; &quot;https://controller:port/v1/scan/repository&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="enable-packet-capture-on-all-pods-in-a-namespace">Enable Packet Capture on All Pods in a Namespace<a href="#enable-packet-capture-on-all-pods-in-a-namespace" class="hash-link" aria-label="Direct link to Enable Packet Capture on All Pods in a Namespace" title="Direct link to Enable Packet Capture on All Pods in a Namespace">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#set -x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hash curl 2&gt;/dev/null || { echo &gt;&amp;2 &quot;Required curl but it&#x27;s not installed.  Aborting.&quot;; exit 1; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hash jq 2&gt;/dev/null || { echo &gt;&amp;2 &quot;Required jq but it&#x27;s not installed.  Aborting.&quot;; exit 1;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">script=&quot;$0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">usage() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Usage: $script -n [namespace] -d [pcap duration (seconds)] -l [https://nvserver:10443]&quot; 1&gt;&amp;2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while getopts &quot;:n:d:l:h&quot; opt; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case $opt in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        n)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            NAMESPACE=$OPTARG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        d)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DURATION=$OPTARG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        l)  URL=&quot;$OPTARG/v1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        h)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            usage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        \?)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            echo &quot;Invalid option, $OPTARG.  Try -h for help.&quot; 1&gt;&amp;2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            echo &quot;Invalid option: $OPTARG requires an argument&quot; 1&gt;&amp;2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    esac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ ! &quot;$NAMESPACE&quot; ] || [ ! &quot;$DURATION&quot; ] || [ ! &quot;$URL&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    usage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">count=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in `kubectl -n $NAMESPACE get pods -o wide 2&gt; /dev/null | tail -n +2 | awk &#x27;{print $1}&#x27; | sed &#x27;s|\(.*\)-.*|\1|&#x27; | uniq`;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CHOICE1[count]=$i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    count=$count+1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ -z ${CHOICE1[0]} ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;No pods found in $NAMESPACE.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for i in &quot;${!CHOICE1[@]}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;$i : ${CHOICE1[$i]}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    read -p &quot;Packet capture on which pod group? &quot; -r</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if [ -n $REPLY ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        POD_STRING=${CHOICE1[$REPLY]}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo $POD_STRING &quot; selected.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sniffer_start() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    URI=&quot;/sniffer?f_workload=$1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sniff_id=$(curl -ks --location --request POST ${URL}${URI} &quot;${curlHeaders[@]}&quot; --data-raw &#x27;{ &quot;sniffer&quot;: { &quot;file_number&quot;: 1, &quot;filter&quot;: &quot;&quot; }}&#x27; | jq .result.id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo $sniff_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sniffer_stop() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    URI=&quot;/sniffer/stop/${1}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    status_code=`curl -ks -w &quot;%{http_code}&quot; --location --request PATCH ${URL}${URI} &quot;${curlHeaders[@]}&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo $status_code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sniffer_pcap_get() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    URI=&quot;/sniffer/${1}/pcap&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    status_code=`curl -ks -w &quot;%{http_code}&quot; --location --request GET ${URL}${URI} &quot;${curlHeaders[@]}&quot; -o $1.pcap`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo $status_code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sniffer_pcap_delete() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    URI=&quot;/sniffer/${1}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    status_code=`curl -ks -w &quot;%{http_code}&quot; --location --request DELETE ${URL}${URI} &quot;${curlHeaders[@]}&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo $status_code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show_menu() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    count=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for i in &quot;Exit script&quot; &quot;Start packet capture for $DURATION seconds&quot; &quot;Download packet capture from pods&quot; &quot;Delete packet capture from pods&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CHOICE2[count]=$i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        count=$count+1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;Selections:&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for i in &quot;${!CHOICE2[@]}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;$i : ${CHOICE2[$i]}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">get_token() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read -p &quot;Enter NeuVector Username: &quot; USER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ -z $USER ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Blank username, exiting...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read -s -p &quot;Enter password: &quot; PASS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ -z $PASS ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Blank password, exiting...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TOKEN=`curl -ks --location --request POST ${URL}/auth \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &quot;accept: application/json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &quot;Content-Type: application/json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-raw &#x27;{&quot;password&quot;: {&quot;username&quot;: &quot;&#x27;$USER&#x27;&quot;, &quot;password&quot;: &quot;&#x27;$PASS&#x27;&quot;}}&#x27;|jq .token.token`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo $TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TOKEN=$(get_token)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while [ &quot;$TOKEN&quot; = &quot;null&quot; ]; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Authenticating failed, retry.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TOKEN=$(get_token)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TOKEN=${TOKEN:1:${#TOKEN}-2}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">declare -a curlHeaders=(&#x27;-H&#x27; &quot;Content-Type: application/json&quot; &#x27;-H&#x27; &quot;X-Auth-Token: $TOKEN&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Pulling worklods from $URL&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">declare -a workloads=&quot;($(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl -ks --location --request GET ${URL}/workload &quot;${curlHeaders[@]}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | jq &#x27;.workloads[] | select(.display_name | startswith(&quot;&#x27;${POD_STRING}&#x27;&quot;))| select(.domain==&quot;&#x27;$NAMESPACE&#x27;&quot; and .cap_sniff==true) | .display_name + &quot;::&quot; +.id&#x27; -r</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">))&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ ${#workloads[@]} -eq 0 ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;No pods is capable of packet capture.  Only ethernet IP part of Kubernetes CIDR can packet capture.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;List of Pods to perform capture on.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Pod Name : ID&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for pods in &quot;${workloads[@]}&quot; ; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        POD_NAME=&quot;${pods%%::*}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        POD_ID=&quot;${pods##*::}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;$POD_NAME : $POD_ID&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while :; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    show_menu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    read -p &quot;Choice? &quot; -r</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if [ -n $REPLY ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        case &quot;$REPLY&quot; in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                exit 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            1)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                counter=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                declare -a sniffs;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                for pods in &quot;${workloads[@]}&quot;; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    POD_ID=&quot;${pods##*::}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    sniff_id=&quot;$(sniffer_start $POD_ID)&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    sniffs[$counter]=$sniff_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    counter=$((counter+1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                echo &quot;Running pcap for ~$DURATION seconds.&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sleep $DURATION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                for sniff_id in &quot;${sniffs[@]}&quot;; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    sniff_id=${sniff_id:1:${#sniff_id}-2}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    status=&quot;$(sniffer_stop $sniff_id)&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                for sniff_id in &quot;${sniffs[@]}&quot;; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    sniff_id=${sniff_id:1:${#sniff_id}-2}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    status=&quot;$(sniffer_pcap_get $sniff_id)&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                for sniff_id in &quot;${sniffs[@]}&quot;; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    sniff_id=${sniff_id:1:${#sniff_id}-2}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    status=&quot;$(sniffer_pcap_delete $sniff_id)&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        esac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="enable-disable-container-quarantine">Enable Disable Container Quarantine<a href="#enable-disable-container-quarantine" class="hash-link" aria-label="Direct link to Enable Disable Container Quarantine" title="Direct link to Enable Disable Container Quarantine">â€‹</a></h4>
<p>The API call to quarantine is via PATCH to /v1/workload/<!-- -->:id<!-- --> with the following body. The workload id is the container/pod id.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">--data-raw &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;config&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;quarantine&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;wire&quot;: &quot;default&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;quarantine_reason&quot;: &quot;violation&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="enable-debugging-mode-for-neuvector-support">Enable Debugging Mode for NeuVector Support<a href="#enable-debugging-mode-for-neuvector-support" class="hash-link" aria-label="Direct link to Enable Debugging Mode for NeuVector Support" title="Direct link to Enable Debugging Mode for NeuVector Support">â€‹</a></h4>
<p>Set access token with your IP, user, password:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">_controllerIP_=&quot;&lt;your_controller_ip&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_controllerRESTAPIPort_=&quot;10443&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_neuvectorUsername_=&quot;admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_neuvectorPassword_=&quot;admin&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Get the authentication token</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -d &#x27;{&quot;password&quot;: {&quot;username&quot;: &quot;&#x27;$_neuvectorUsername_&#x27;&quot;, &quot;password&quot;: &quot;&#x27;$_neuvectorPassword_&#x27;&quot;}}&#x27; &quot;https://$_controllerIP_:$_controllerRESTAPIPort_/v1/auth&quot; &gt; /dev/null 2&gt;&amp;1 &gt; token.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_TOKEN_=`cat token.json | jq -r &#x27;.token.token&#x27;`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Enable Debug Mode</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X PATCH -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;config&quot;: {&quot;controller_debug&quot;: [&quot;cpath&quot;, &quot;conn&quot;]}}&#x27; &quot;https://$_controllerIP_:$_controllerRESTAPIPort_/v1/system/config&quot;  &gt; /dev/null 2&gt;&amp;1   &gt; set_debug.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#debug options - cpath, conn, mutex, scan, cluster , all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Disable Debug on all controllers in a cluster</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X PATCH -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;config&quot;: {&quot;controller_debug&quot;: []}}&#x27; &quot;https://$_controllerIP_:$_controllerRESTAPIPort_/v1/system/config&quot;  &gt; /dev/null 2&gt;&amp;1   &gt; set_debug.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Check the controller debug status in a cluster</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl  -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot;  &quot;https://$_controllerIP_:$_controllerRESTAPIPort_/v1/system/config&quot;  &gt; /dev/null 2&gt;&amp;1   &gt; system_setting.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat system_setting.json | jq .config.controller_debug</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Logout</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` log out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X &#x27;DELETE&#x27; -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; &quot;https://$_controllerIP_:$_controllerRESTAPIPort_/v1/auth&quot; &gt; /dev/null 2&gt;&amp;1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="report-if-a-vulnerability-is-in-the-base-image-layers">Report if a vulnerability is in the base image layers<a href="#report-if-a-vulnerability-is-in-the-base-image-layers" class="hash-link" aria-label="Direct link to Report if a vulnerability is in the base image layers" title="Direct link to Report if a vulnerability is in the base image layers">â€‹</a></h4>
<p>To identify CVE&#x27;s in the base image when using REST API to scan images, the base image must be identified in the API call, as in the example below.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; -d &#x27;{&quot;request&quot;: {&quot;registry&quot;: &quot;https://registry.hub.docker.com/&quot;, &quot;repository&quot;: &quot;garricktam/debian&quot;, &quot;tag&quot;: &quot;latest&quot;, &quot;scan_layers&quot;: false, &quot;base_image&quot;: &quot;2244...../nodejs:3.2......&quot;}}&#x27; &quot;https://$RESTURL/v1/scan/repository&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{noformat}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Limitations:</strong> If the image to be scanned is a remote image, with &quot;registry&quot; specified, the base image must also be a remote image, and the name must start with http or https.  If the image to be scanned is a local image, then the base image must also be a local image as well.</p>
<p>For example,</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;request&quot;: {&quot;repository&quot;: &quot;neuvector/manager&quot;, &quot;tag&quot;: &quot;4.0.2&quot;, &quot;scan_layers&quot;: true, &quot;base_image&quot;: &quot;alpine:3.12.0&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;request&quot;: {&quot;registry&quot;: &quot;https://10.1.127.12:5000/&quot;, &quot;repository&quot;: &quot;neuvector/manager&quot;, &quot;tag&quot;: &quot;4.0.0&quot;, &quot;scan_layers&quot;: true, &quot;base_image&quot;: &quot;https://registry.hub.docker.com/alpine:3.12.0&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;request&quot;: {&quot;repository&quot;: &quot;neuvector/manager&quot;, &quot;tag&quot;: &quot;4.0.2&quot;, &quot;scan_layers&quot;: true, &quot;base_image&quot;: &quot;10.1.127.12:5000/neuvector/manager:4.0.2â€}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-cve-database-version-and-date">Get the CVE Database Version and Date<a href="#get-the-cve-database-version-and-date" class="hash-link" aria-label="Direct link to Get the CVE Database Version and Date" title="Direct link to Get the CVE Database Version and Date">â€‹</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_&quot; &quot;https://127.0.0.1:10443/v1/scan/scanner&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Output:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	&quot;scanners&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;cvedb_create_time&quot;: &quot;2020-07-07T10:34:04Z&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;cvedb_version&quot;: &quot;1.950&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;id&quot;: &quot;0f043705948557828ac1831ee596588a0d050950113117ddd19ecd604982f4d9&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;port&quot;: 18402,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;server&quot;: &quot;127.0.0.1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;cvedb_create_time&quot;: &quot;2020-07-07T10:34:04Z&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;cvedb_version&quot;: &quot;1.950&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;id&quot;: &quot;9fa02c644d603f59331c95735158d137002d32a75ed1014326f5039f38d4d717&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;port&quot;: 18402,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			&quot;server&quot;: &quot;192.168.9.95&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="manage-federation-for-master-and-remote-worker-clusters">Manage Federation for Master and Remote (Worker) Clusters<a href="#manage-federation-for-master-and-remote-worker-clusters" class="hash-link" aria-label="Direct link to Manage Federation for Master and Remote (Worker) Clusters" title="Direct link to Manage Federation for Master and Remote (Worker) Clusters">â€‹</a></h4>
<p>Generally, listing Federation members can use a GET to the following endpoint (see samples for specific syntax):
<a href="https://neuvector-svc-controller.neuvector:10443/v1/fed/member" target="_blank" rel="noopener noreferrer">https://neuvector-svc-controller.neuvector:10443/v1/fed/member</a></p>
<p>Selected Federation Management API&#x27;s:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">_masterClusterIP_=$1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_workerClusterIP_=$2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># this is used if one of clusters is going to be kicked by master cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_CLUSTER_name_=$3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] login as default admin user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -d &#x27;{&quot;password&quot;: {&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;}}&#x27; &quot;https://$_masterClusterIP_:10443/v1/auth&quot; &gt; /dev/null 2&gt;&amp;1 &gt; ./$_LOGFOLDER_/token.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_TOKEN_M_=`cat ./$_LOGFOLDER_/token.json | jq -r &#x27;.token.token&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] promote to master cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_M_&quot; -d &#x27;{&quot;master_rest_info&quot;: {&quot;port&quot;: 11443, &quot;server&quot;: &quot;&#x27;$_masterClusterIP_&#x27;&quot;}, &quot;name&quot;: &quot;master&quot;}&#x27; &quot;https://$_masterClusterIP_:10443/v1/fed/promote&quot; &gt; /dev/null 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] idle 6 seconds for logon session timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sleep 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] login as default admin user on master cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -d &#x27;{&quot;password&quot;: {&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;}}&#x27; &quot;https://$_masterClusterIP_:10443/v1/auth&quot; &gt; /dev/null 2&gt;&amp;1 &gt; ./token.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_TOKEN_M_=`cat ./token.json | jq -r &#x27;.token.token&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] checking fed join_token on master cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_M_&quot; &quot;https://$_masterClusterIP_:10443/v1/fed/join_token&quot; &gt; /dev/null 2&gt;&amp;1 &gt; ./join_token.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat ./join_token.json | jq -c .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_JOIN_TOKEN_=`cat ./join_token.json | jq -r &#x27;.join_token&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] login as default admin user on worker cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -d &#x27;{&quot;password&quot;: {&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;}}&#x27; &quot;https://$_workerClusterIP_:10443/v1/auth&quot; &gt; /dev/null 2&gt;&amp;1 &gt; ./token.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_TOKEN_W_=`cat ./token.json | jq -r &#x27;.token.token&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] joining the cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_W_&quot; -d &#x27;{&quot;join_token&quot;: &quot;&#x27;$_JOIN_TOKEN_&#x27;&quot;, &quot;name&quot;: &quot;worker&quot;, &quot;joint_rest_info&quot;: {&quot;port&quot;: 10443, &quot;server&quot;: &quot;&#x27;$_workerClusterIP_&#x27;&quot;}}&#x27; &quot;https://$_workerClusterIP_:10443/v1/fed/join&quot; &gt; /dev/null 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] idle 9 seconds for events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sleep 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">########## whenever there is a change on cluster such as a cluster is kicked/left/joined, run this to check the status ############</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] checking fed member on master cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_M_&quot; &quot;https://$_masterClusterIP_:10443/v1/fed/member&quot; &gt; /dev/null 2&gt;&amp;1 &gt; ./fedMember.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat ./fedMember.json | jq -c .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] checking fed member on worker cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_W_&quot; &quot;https://$_workerClusterIP_:10443/v1/fed/member&quot; &gt; /dev/null 2&gt;&amp;1 &gt; ./fedMember.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat ./fedMember.json | jq -c .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_CLUSTER_id_=`cat ./fedMember.json | jq -r --arg _CLUSTER_name_ &quot;$_CLUSTER_name_&quot; &#x27;.joint_clusters[] | select(.name == $_CLUSTER_name_).id&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">###################################################################################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">########## for ur information to leave or kick the cluster ############</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] requesting to leave on worker cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_W_&quot; -d &#x27;{&quot;force&quot;: false}&#x27; &quot;https://$_workerClusterIP_:10443/v1/fed/leave&quot; &gt; /dev/null 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] idle 9 seconds for events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sleep 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] requesting to kick on master cluster, $_CLUSTER_id_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X &quot;DELETE&quot; -H &quot;Content-Type: application/json&quot; -H &quot;X-Auth-Token: $_TOKEN_M_&quot; &quot;https://$_masterClusterIP_:10443/v1/fed/cluster/$_CLUSTER_id_&quot; &gt; /dev/null 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo `date +%Y%m%d_%H%M%S` [$_curCase_] idle 9 seconds for events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sleep 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#######################################################################</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/neuvector/docs/edit/main/versioned_docs/version-5.3/11.automation/02.automation/02.automation.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/automation/ci_workflow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">NeuVector Workflow</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/troubleshooting"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">12. Troubleshooting</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#neuvector-automation" class="table-of-contents__link toc-highlight">NeuVector Automation</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 SUSE NeuVector. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>