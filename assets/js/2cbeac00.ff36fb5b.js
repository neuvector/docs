"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2201],{94023:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>l,toc:()=>a});var t=i(74848),r=i(28453);const c={title:"CircleCI",taxonomy:{category:"docs"},slug:"/scanning/build/circleci"},o=void 0,l={id:"scanning/build/circleci/circleci",title:"CircleCI",description:"Scan for Vulnerabilities in the CircleCI Build Pipeline",source:"@site/docs/06.scanning/03.build/03.circleci/03.circleci.md",sourceDirName:"06.scanning/03.build/03.circleci",slug:"/scanning/build/circleci",permalink:"/next/scanning/build/circleci",draft:!1,unlisted:!1,editUrl:"https://github.com/neuvector/docs/edit/main/docs/06.scanning/03.build/03.circleci/03.circleci.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"CircleCI",taxonomy:{category:"docs"},slug:"/scanning/build/circleci"},sidebar:"tutorialSidebar",previous:{title:"Bamboo",permalink:"/next/scanning/build/bamboo"},next:{title:"Azure DevOps",permalink:"/next/scanning/build/azuredevops"}},s={},a=[{value:"Scan for Vulnerabilities in the CircleCI Build Pipeline",id:"scan-for-vulnerabilities-in-the-circleci-build-pipeline",level:3},{value:"Create a Context in Your CircleCI App",id:"create-a-context-in-your-circleci-app",level:4},{value:"Configure Settings",id:"configure-settings",level:4},{value:"Review the Results",id:"review-the-results",level:4}];function d(e){const n={a:"a",code:"code",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h3,{id:"scan-for-vulnerabilities-in-the-circleci-build-pipeline",children:"Scan for Vulnerabilities in the CircleCI Build Pipeline"}),"\n",(0,t.jsxs)(n.p,{children:["The NeuVector CircleCI ORB triggers a vulnerability scan on an image in the CircleCI pipeline. The ORB is available in the ",(0,t.jsx)(n.a,{href:"https://circleci.com/orbs/registry/orb/neuvector/neuvector-orb",children:"CircleCI catalog"})," and is also documented on the ",(0,t.jsx)(n.a,{href:"https://github.com/neuvector/circleci-orb",children:"NeuVector GitHub page"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Deploy the NeuVector Allinone or Controller container if you haven't already done so on a host reachable by the CircleCI ORB. Make a note of the IP address of the host where the Allinone or Controller is running."}),"\n",(0,t.jsx)(n.p,{children:"The ORB supports two use cases:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Triggering the scan to be performed outside the CirclCI infrastructure. The ORB contacts the NeuVector scanner, which then pulls the image from a registry to be scanned. Make sure the ORB has network connectivity to the host where the NeuVector Controller/Allinone is running."}),"\n",(0,t.jsxs)(n.li,{children:["Dynamically launching a NeuVector controller and scanner on a temporary vm running on the CircleCI platform. After launching and auto-configuring, the scan be done on image in the build, and after completion the NeuVector deployment is stopped and removed.  For this use case, please see the documentation on the ",(0,t.jsx)(n.a,{href:"https://circleci.com/orbs/registry/orb/neuvector/neuvector-orb",children:"CircleCI ORB for NeuVector"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"In addition, make sure there is a NeuVector scanner container deployed and configured to connect to the Allinone or Controller. In 4.0 and later, the neuvector/scanner container must be deployed separate from the allinone or controller."}),"\n",(0,t.jsx)(n.h4,{id:"create-a-context-in-your-circleci-app",children:"Create a Context in Your CircleCI App"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"context",src:i(22767).A+"",width:"2866",height:"1172"})}),"\n",(0,t.jsx)(n.h4,{id:"configure-settings",children:"Configure Settings"}),"\n",(0,t.jsx)(n.p,{children:"Configure the Environment Variables for Connecting to and Authenticating"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"settings",src:i(30874).A+"",width:"2864",height:"1166"})}),"\n",(0,t.jsx)(n.p,{children:"Add the NeuVector orb to Your Build config.yaml"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'version: 2.1\norbs:\n  neuvector: neuvector/neuvector-orb@1.0.0\nworkflows:\n  scan-image:\n    jobs:\n      - neuvector/scan-image:\n          context: myContext\n          registry_url: https://registry.hub.docker.com\n          repository: alpine\n          tag: "3.4"\n          scan_layers: false\n          high_vul_to_fail: 0\n          medium_vul_to_fail: 3\n'})}),"\n",(0,t.jsx)(n.p,{children:"The registry_url is the location to find the image to be scanned. Configure the repository name, tag, and if a layered scan should be performed. Add criteria for the build task to fail based on number of high or medium vulnerabilities detected."}),"\n",(0,t.jsx)(n.h4,{id:"review-the-results",children:"Review the Results"}),"\n",(0,t.jsxs)(n.p,{children:["The build task will pass or fail based on the criteria set. In either case you can review the full scan report.\n",(0,t.jsx)(n.img,{alt:"fail",src:i(33001).A+"",width:"2864",height:"1148"})]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},33001:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/circleci_fail-0ae29be1b1906f98e647581cd024ebc1.png"},30874:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/circleci_settings-2d9212f1e52f81b245a0f247717ec07b.png"},22767:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/context-7757aba1a8e52f6d8841705b0ea8632c.png"},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var t=i(96540);const r={},c=t.createContext(r);function o(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);